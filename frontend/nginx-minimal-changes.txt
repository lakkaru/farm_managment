# MINIMAL CHANGES to add to your existing nginx config
# Add these lines to fix the authentication and routing issues

# 1. Add to your existing /api/ location block (after the existing proxy_* lines):
        add_header Access-Control-Allow-Origin https://farm.lakkaru.com always;
        add_header Access-Control-Allow-Methods 'GET, POST, PUT, DELETE, OPTIONS' always;
        add_header Access-Control-Allow-Headers 'Authorization, Content-Type' always;
        add_header Access-Control-Allow-Credentials true always;

# 2. Replace your frontend location block:
    location / {
        try_files $uri $uri/ @fallback;
    }
    
    location @fallback {
        rewrite ^.*$ /index.html last;
    }

# 3. Change your error_page line:
    error_page 404 /index.html;